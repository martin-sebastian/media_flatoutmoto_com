import"./bootstrap.esm-CgEsG6e6.js";/* empty css              */import"./bootstrap-init-CxX6viQq.js";/* empty css           */const c="https://nawvhznauxovsfjgawti.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5hd3Zoem5hdXhvdnNmamdhd3RpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1MzkwMTEsImV4cCI6MjA2NzExNTAxMX0.wk5vBEU5M0-BcWOngJSVrIVKwJeDP6jaBSNo02n0v6c",d={apikey:l,Authorization:`Bearer ${l}`,"Content-Type":"application/json",Prefer:"return=representation"};let a={};async function u(){const t=await fetch(`${c}/rest/v1/tv_display_settings?select=*&order=setting_key`,{headers:d});if(!t.ok)throw new Error(`Failed to load settings: ${t.status}`);return t.json()}async function m(t,n){const e=await fetch(`${c}/rest/v1/tv_display_settings?setting_key=eq.${t}`,{method:"PATCH",headers:d,body:JSON.stringify({setting_value:n,updated_at:new Date().toISOString()})});if(!e.ok)throw new Error(`Failed to update ${t}: ${e.status}`);return e.json()}function g(t){const n=document.getElementById("settingsFields");n.innerHTML="",n.classList.remove("d-none"),n.classList.add("d-flex","flex-column","gap-3");for(const e of t){const s=document.createElement("div");s.className="tv-panel p-3",s.innerHTML=`
      <label for="field-${e.setting_key}" class="form-label fw-semibold">
        ${e.label}
      </label>
      <input
        type="number"
        class="form-control setting-input"
        id="field-${e.setting_key}"
        data-key="${e.setting_key}"
        value="${e.setting_value}"
        step="any"
      />
      <div class="form-text text-secondary">${e.description||""}</div>
    `,n.appendChild(s),a[e.setting_key]=Number(e.setting_value)}document.getElementById("settingsActions").classList.remove("d-none"),document.getElementById("settingsActions").classList.add("d-flex"),n.querySelectorAll(".setting-input").forEach(e=>{e.addEventListener("input",o)})}function o(){const t=document.querySelectorAll(".setting-input");let n=!1;for(const e of t)if(Number(e.value)!==a[e.dataset.key]){n=!0;break}document.getElementById("saveBtn").disabled=!n,document.getElementById("resetBtn").disabled=!n}async function p(){const t=document.getElementById("saveBtn"),n=document.getElementById("saveStatus");t.disabled=!0,t.innerHTML='<span class="spinner-border spinner-border-sm me-1"></span> Saving...';try{const e=document.querySelectorAll(".setting-input"),s=[];for(const i of e){const r=Number(i.value);r!==a[i.dataset.key]&&s.push(m(i.dataset.key,r))}await Promise.all(s);for(const i of e)a[i.dataset.key]=Number(i.value);n.innerHTML='<div class="alert alert-success py-2 small"><i class="bi bi-check-circle me-1"></i> Settings saved. Changes take effect on next TV display load.</div>',setTimeout(()=>{n.innerHTML=""},4e3)}catch(e){n.innerHTML=`<div class="alert alert-danger py-2 small"><i class="bi bi-exclamation-triangle me-1"></i> ${e.message}</div>`}finally{t.innerHTML='<i class="bi bi-check-lg me-1"></i> Save Changes',o()}}function y(){const t=document.querySelectorAll(".setting-input");for(const n of t)n.value=a[n.dataset.key];o(),document.getElementById("saveStatus").innerHTML=""}async function v(){try{const t=await u();document.getElementById("settingsLoader").remove(),g(t),document.getElementById("saveBtn").addEventListener("click",p),document.getElementById("resetBtn").addEventListener("click",y)}catch(t){document.getElementById("settingsLoader").innerHTML=`<div class="alert alert-danger">${t.message}</div>`}}v();
